CREATE TABLE IF NOT EXISTS "customers" ("CustomerID" INT, "Segment" VARCHAR, "Currency" VARCHAR, PRIMARY KEY ("CustomerID"));

CREATE TABLE IF NOT EXISTS "gasstations" ("GasStationID" INT, "ChainID" INT, "Country" VARCHAR, "Segment" VARCHAR, PRIMARY KEY ("GasStationID"));

CREATE TABLE IF NOT EXISTS "products" ("ProductID" INT, "Description" VARCHAR, PRIMARY KEY ("ProductID"));

CREATE TABLE IF NOT EXISTS "transactions_1k" ("TransactionID" INT, "Date" DATE, "Time" VARCHAR, "CustomerID" INT, "CardID" INT, "GasStationID" INT, "ProductID" INT, "Amount" INT, "Price" FLOAT, PRIMARY KEY ("TransactionID"));

CREATE TABLE IF NOT EXISTS "yearmonth" ("CustomerID" INT, "Date" VARCHAR, "Consumption" FLOAT);

SELECT CAST(SUM(CASE WHEN T1.Segment = 'SME' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(CASE WHEN T1.Segment = 'LAM' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID), CAST(SUM(CASE WHEN T1.Segment = 'LAM' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(CASE WHEN T1.Segment = 'KAM' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID), CAST(SUM(CASE WHEN T1.Segment = 'KAM' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(CASE WHEN T1.Segment = 'SME' THEN T2.Consumption ELSE 0 END) AS FLOAT) / COUNT(T1.CustomerID) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Consumption = (SELECT MIN(Consumption) FROM yearmonth) AND T2.Date BETWEEN 201301 AND 201312;

SELECT (SELECT AVG(T3.Consumption) FROM yearmonth AS T3 INNER JOIN customers AS T4 ON T3.CustomerID = T4.CustomerID WHERE T4.Segment = 'SME' AND T4.Currency = 'CZK' AND SUBSTR(T3.Date, 1, 4) = '2013') - (SELECT AVG(T5.Consumption) FROM yearmonth AS T5 INNER JOIN customers AS T6 ON T5.CustomerID = T6.CustomerID WHERE T6.Segment = 'LAM' AND T6.Currency = 'CZK' AND SUBSTR(T5.Date, 1, 4) = '2013') AS SME_LAM_Difference, (SELECT AVG(T7.Consumption) FROM yearmonth AS T7 INNER JOIN customers AS T8 ON T7.CustomerID = T8.CustomerID WHERE T8.Segment = 'LAM' AND T8.Currency = 'CZK' AND SUBSTR(T7.Date, 1, 4) = '2013') - (SELECT AVG(T9.Consumption) FROM yearmonth AS T9 INNER JOIN customers AS T10 ON T9.CustomerID = T10.CustomerID WHERE T10.Segment = 'KAM' AND T10.Currency = 'CZK' AND SUBSTR(T9.Date, 1, 4) = '2013') AS LAM_KAM_Difference, (SELECT AVG(T11.Consumption) FROM yearmonth AS T11 INNER JOIN customers AS T12 ON T11.CustomerID = T12.CustomerID WHERE T12.Segment = 'KAM' AND T12.Currency = 'CZK' AND SUBSTR(T11.Date, 1, 4) = '2013') - (SELECT AVG(T13.Consumption) FROM yearmonth AS T13 INNER JOIN customers AS T14 ON T13.CustomerID = T14.CustomerID WHERE T14.Segment = 'SME' AND T14.Currency = 'CZK' AND SUBSTR(T13.Date, 1, 4) = '2013') AS KAM_SME_Difference